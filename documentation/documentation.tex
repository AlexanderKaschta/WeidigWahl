% NOTE:
% Compile only with XeLaTeX or LuaLaTeX
%
\documentclass[ngerman]{ltxdoc}
\usepackage{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8x]{inputenc}

\usepackage{parskip}
\usepackage{setspace}
\usepackage{xspace}
\onehalfspacing

\usepackage{etoolbox}
\usepackage{ifxetex}
\usepackage{ifluatex}

\ifboolexpr{bool {xetex} or bool {luatex}}{
  \usepackage{fontspec}
  \defaultfontfeatures{Ligatures=TeX}

  \newcounter{fontsnotfound}
  \newcommand{\checkfont}[1]{%
    \suppressfontnotfounderror=1%
    \font\x = "#1" at 10pt
    \selectfont
    \ifx\x\nullfont%
      \stepcounter{fontsnotfound}%
    \fi%
    \suppressfontnotfounderror=0%
  }

  \newcommand{\iffontsavailable}[3]{%
    \setcounter{fontsnotfound}{0}%
    \expandafter\forcsvlist\expandafter%
    \checkfont\expandafter{#1}%
    \ifnum\value{fontsnotfound}=0%
      #2%
    \else%
      #3%
    \fi%
  }
  \iffontsavailable{Fira Sans Light,%
                Fira Sans Light Italic,%
                Fira Sans,%
                Fira Sans Italic}{%
    \setmainfont[BoldFont={Fira Sans}]{Fira Sans Light}%
  }{%
    \iffontsavailable{Fira Sans Light OT,%
                  Fira Sans Light Italic OT,%
                  Fira Sans OT,%
                  Fira Sans Italic OT}{%
      \setmainfont[BoldFont={Fira Sans OT}]{Fira Sans Light OT}%
    }{%
      \typeout{%
        Could not find Fira Sans fonts. Creating documentation%
        with standard fonts.%
      }
    }
  }
  \iffontsavailable{Fira Mono, Fira Mono Bold}{%
    \setmonofont{Fira Mono}%
  }{%
    \iffontsavailable{Fira Mono OT, Fira Mono Bold OT}{%
      \setmonofont{Fira Mono OT}%
    }{%
      \typeout{%
        Could not find Fira Sans fonts. Creating documentation%
        with standard monospaced fonts.%
      }
    }
  }
}{
  \typeout{%
    You need to compile with XeLaTeX or LuaLaTeX to use the Fira fonts.%
  }
}

\usepackage{enumitem}
\setlist[itemize]{noitemsep}
\setlist[enumerate]{noitemsep}

\usepackage{xcolor}
\definecolor{mDarkBrown}{HTML}{604c38}
\definecolor{mDarkTeal}{HTML}{23373b}
\definecolor{mLightBrown}{HTML}{EB811B}
\definecolor{mLightGreen}{HTML}{14B03D}
\definecolor{mBackground}{HTML}{FFFFFF}

\usepackage{listings}

\lstdefinestyle{license}{
  basicstyle=\fontsize{7}{11}\selectfont\ttfamily,
  breaklines=true
}

\lstdefinestyle{tex}{
  language=[LaTeX]{TeX},
  basicstyle=\ttfamily,
  keywordstyle=\color{mLightBrown}\bfseries,
  commentstyle=\color{mLightGreen},
  stringstyle=\color{mLightGreen},
  backgroundcolor=\color{mBackground},
  numbers=none,
  numberstyle=\tiny\ttfamily,
  stepnumber=2,
  showspaces=false,
  showstringspaces=false,
  showtabs=false,
  frame=none,
  framerule=1pt,
  tabsize=2,
  rulesep=5em,
  captionpos=b,
  breaklines=true,
  breakatwhitespace=false,
  framexleftmargin=0em,
  framexrightmargin=0em,
  xleftmargin=0em,
  xrightmargin=0em,
  aboveskip=1em,
  belowskip=1em,
  morekeywords={usetheme,institute,maketitle,@metropolis@titleformat,%
                plain,setbeamercolor,metroset,setsansfont,setmonofont},
}


\lstMakeShortInline|
\usepackage{metalogo}

\usepackage[colorlinks=true,
            linkcolor=mLightBrown,
            menucolor=mLightBrown,
            pagecolor=mLightBrown,
            urlcolor=mLightBrown]{hyperref}

\newcommand{\DescribeOption}[4]{
  \DescribeMacro{#1}
  \begin{minipage}[t]{\textwidth}
    \textit{\textbf{\textcolor{mLightGreen}{#2}}}\dotfill\,#3\par
    \begingroup
    \vspace{0.5em}#4\par
    \endgroup
  \end{minipage}
}

\newcommand{\name}{\textbf{\textsc{WeidigWahl}}\xspace}

\title{Technische Dokumentation der Software \name}
\author{Alexander Kaschta \\ \url{https://github.com/AlexanderKaschta}}
\date{1.1.0 ~---~ \today}

\begin{document}

\maketitle
\tableofcontents

\section{Einführung}

Dies ist die technische Dokumentation von \name. \name entstand im Ramen des
Informatikunterrichts und dient zur einfachen Durchführung von Kurswahlen an Schulen.
Die Anwendung ist webbasiert und läuft dann im Internet.

Die Schüler bzw. Teilnehmer kriegen am Anfang Zugangsdaten zu der Platform, wo
sie sich dann anmelden können. Dort finden sie allerlei Informationen zu der Wahl
und zu allen Kursen, die zur Auswahl stehen. Dort können die Schüler bis zu einer
festgelegten Deadline ihre Stimme oder Stimmen abgeben, welche Kurse sie gerne
besuchen würden. Sobald die Wahl dann abgelaufen ist, kann dann die Wahl
elektronisch ausgewertet werden.

Das System hat den Vorteil, dass man sich sehr viel Papier sparen kann. Denn es
wird keinerlei Papier mehr benötigt. Außerdem ist die Auswertung sehr einfach, da
man die Einteilung nicht selbst macht, sondern ein Algorithmus die Aufgabe übernimmt.
Dieser ist deutlich schneller und beachtet alle von den Schülern abgegebenen Wünsche.
Natürlich kann das System nicht alle Wünsche erfüllen, aber die Ursache der Problematik
liegt im Ursprung des Problems der Einteilung und würde auch bei einer manuellen
Wahl nicht verhindert werden können.

\section{Installation}

\subsection{Systemanforderungen}

Zur Installation von \name werden folgende Komponenten benötigt:

\begin{itemize}
  \item \href{http://httpd.apache.org/}{Apache HTTP Server} oder ähnlicher Server
  \item \href{https://www.php.net/}{PHP} 7+
  \item \href{https://mariadb.org/}{MariaDB} oder \href{https://www.mysql.com/}{MySQL}\footnote{Nicht getestet}
  \item PDO-Erweiterung für \href{https://www.php.net/}{PHP}
  \item PDO-MySQL-Treiber für \href{https://www.php.net/}{PHP}
  \item \href{https://www.phpmyadmin.net/}{phpMyAdmin}
  \item Ein Texteditor
\end{itemize}

Optional bzw. nach Bedarf:

\begin{itemize}
  \item \href{https://git-scm.com/}{Git}
  \item FTP-Client
\end{itemize}

\subsection{Installation}

Zum Beginn der Installation muss man sich eine Kopie des Software-Pakets besorgen.
Dies kann auf zwei Arten passieren. Man kann den Quellcode entweder mittels \href{https://git-scm.com/}{Git}
auf die eigene Festplatte klonen oder direkt als Zip-Paket vom
\href{https://github.com/AlexanderKaschta/WeidigWahl}{GitHub-Repository}\footnote{\url{https://github.com/AlexanderKaschta/WeidigWahl}} herunterladen.

Zum Download der Zip-Datei öffnet man den Link zum Repository im Internet-Browsers
seines Vertrauens. Dort muss man zuerst auf \glqq Clone or download\grqq{} und dann
auf \glqq Download Zip\grqq{} klicken. Nach dem Download muss die entsprechende
ZIP-Datei noch entpackt werden.

Für das Klonen mittels \href{https://git-scm.com/}{Git} muss nur folgender Befehl
in der Kommandozeile ausgeführt werden.

\begin{lstlisting}[style=tex]
$ git clone https://github.com/AlexanderKaschta/WeidigWahl.git
\end{lstlisting}

Nun öffnet man den Ordner mit dem Quellcode. Dort sollte man folgende Ordnerstruktur vorfinden:

\begin{multicols}{3}
  \begin{itemize}
    \item |core|
    \item |css|
    \item |docs|
    \item |documentation|
    \item |js|
    \item |sql|
    \item |uploads|
    \item |webfonts|
  \end{itemize}
\end{multicols}

\subsection{Datenbank}

Man benötigt eine Datenbank für \name. Dazu benötigen wir entweder \href{https://mariadb.org/}{MariaDB}
oder \href{https://www.mysql.com/}{MySQL}. Das ganze wurde mittels MariaDB entwickelt,
da diese kompatibel zu MySQL sollte auch diese funktionieren. Dies wurde bis jetzt
jedoch noch nicht getestet. Man könnte auch noch eine andere Datenbank verwenden,
jedoch bräuchte man dafür den entsprechenden PDO-Treiber und müsste alle SQL-Befehle
anpassen, sodass diese kompatibel mit der entsprechende Datenbank sind.

Es kann für \name eine vorhandene Datenbank benutzt werden, wenn folgende Tabellen
noch erstellt werden können bzw. noch nicht benutzt werden. Natürlich kann man
auch eine komplett neue Datenbank erstellen.

\begin{multicols}{3}
  \begin{itemize}
    \item |tbl_users|
    \item |tbl_sportwahl|
    \item |tbl_kurse|
    \item |tbl_teilnehmer|
    \item |tbl_ergebnisse|
  \end{itemize}
\end{multicols}

Die entsprechende Datenbank wird dann mit \href{https://www.phpmyadmin.net/}{phpMyAdmin} geöffnet. Nun müssen die benötigten
Tabellen erstellt werden. Alle SQL-Befehle zum erstellen der entsprechende Tabellen sind
in der Datei |sql/setup.sql| dokumentiert. Diese Befehle kopiert man dann und führt sie
über \href{https://www.phpmyadmin.net/}{phpMyAdmin} aus. Am Ende sollte die Datenbank
dann alle fünf Tabellen enthalten.

Nun muss man jetzt nur noch einen Benutzer mit Administratorrechten erstellen. Dazu muss
dieser SQL-Befehl ausgeführt werden. Benutzername als auch das Passwort sollten
dazu geändert werden.

\begin{lstlisting}[language=SQL, breaklines=true]
INSERT INTO tbl_users (vorname, nachname, benutzername, geburtsdatum, passwort, ist_aktiv, jahrgang, klasse, datum_erstellt, datum_letzte_anderung, kann_reset_anfordern, ist_admin) VALUES
('Max', 'Mustermann', 'admin', '1970-01-01', 'passwort', 1, 99, 'Admins', NOW(), NOW(), 1, 1);
\end{lstlisting}

\subsection{Konfiguration}

Für die gesamte Konfiguration von \name gibt es eine zentrale Konfigurationsdatei.
Diese heißt |config.php| und liegt im |core/config.php|. In dieser Datei sind alle
für den Betrieb notwendige Variablen abgebildet und werden dort entsprechend entnommen.

\DescribeOption{Option}{Name der Option}{Standardwert}{
  Eine kurze Beschreibung der Option.
}

Dabei ist die Eigenschaft im PHP-Code wie folgt abgebildet:

\begin{lstlisting}[language=PHP, breaklines=true]
define("Option", "Standardwert");
\end{lstlisting}

Folgende Eigenschaften gibt es:

\DescribeOption{DB\_HOST}{Hostadresse der Datenbank}{localhost}{
  In diesem Feld wird die Adresse zum Hostserver der Datenbank eingetragen. Da
  sehr häufig der Webserver auf einem anderem Server läuft als die Datenbank, so
  muss man passend angeben, wo die Datenbank zu erreichen ist. Der Standardwert
  |localhost| ist die Hostadresse zum eigenem Rechner. Sie ist äquivalent zu
  |127.0.0.1| .
}

\DescribeOption{DB\_USER}{Benutzername für die Datenbank}{root}{
  Der Zugang zu einer Datenbank benötigt Zugangsdaten. Dabei handelt es sich um
  einen Benutzernamen und das dazu passende Passwort. Bei \href{https://mariadb.org/}{MariaDB}
  oder \href{https://www.mysql.com/}{MySQL} ist der Standartbenutzername nach der
  Installation immer |root|, falls dies nicht geändert worden ist oder noch ein
  weiterer Benutzer zur Datenbank hinzugefügt worden ist.
}

\DescribeOption{DB\_PASSWORT}{Passwort für die Datenbank}{\glqq\grqq}{
  Der Zugang zu einer Datenbank benötigt Zugangsdaten. Dabei handelt es sich um
  einen Benutzernamen und das dazu passende Passwort. Bei \href{https://mariadb.org/}{MariaDB}
  oder \href{https://www.mysql.com/}{MySQL} ist das Standartpasswort für den Benutzer
  |root| nach der Installation immer ein leere Zeichenkette. Falls dieses Passwort
  geändert worden ist oder ein anderer Benutzer benutzt wird, dann muss dieses entsprechend
  angepasst werden.
}

\DescribeOption{DB\_NAME}{Name für die Datenbank}{weidigwahl}{
  Dies ist der Name der Datenbank, welche die vorher erstellt Tabellen enthält.
  Da ein Datenbankserver mehrere Datenbank bereitgestellen kann, muss immer angegeben
  werden, um welche Datenbank es sich konkret handelt.
}

\DescribeOption{PROJECT\_NAME}{Anzeigename für Titelleiste}{\name}{
Diese Option spezifiziert den Namen der den Nutzer in der Titelleiste des Browsers
bei der Benutzung angezeigt wird. Diese Eigenschaft muss nicht zwingen geändert
werden.
}

\DescribeOption{PROJECT\_VERSION}{Versionsnummer der Software}{1.1.0}{
Dies ist die Versionsnummer der aktuell installierten Software. Diese wird nur
intern verwendet und \textbf{sollte nicht} geändert werden.
}

\DescribeOption{ADMINISTRATOR}{Name des Administrators}{Hr. Mustermann}{
Dies ist der Name des Administrators, welcher auf der Hauptseite angezeigt wird.
Er ist der Ansprechpartner an dem man sich wenden kann, falls man Probleme hat
oder irgendwelche unerwarteten Fehler aufgetreten sind.
}

\DescribeOption{GITHUB\_LINK}{GitHub-Link}{https://www.github.com/AlexanderKaschta/WeidigWahl}{
Dies ist der Link zum GitHub-Repository dieser Anwendung. Diese wird nur
intern verwendet und \textbf{sollte nicht} geändert werden.\\
Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{PASSWORD\_LENGTH}{Passwortlänge}{8}{
Hiermit wird die Länge der automatisch generierten Passwörter festgelegt. Ist diese
Variable nicht angegeben oder ist die eingetragene Länge kleiner als \textbf{8},
so wird die Länge \textbf{8} verwendet. Ansonsten wird die angegebene Länge verwendet.
Der ganze Mechanismus dient dazu, dass keine wirklich unsicheren Passwörter erstellt
werden.\\
Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{SCHOOL}{Schule}{Weidigschule}{
Dies ist der Name der Schule, die dieses System verwendet. Der Name wird nur im
Footer verwendet und dort an zwei Stellen angezeigt. Einmal als Schule, die das
System verwendet und das zweite Mal im Copyright-Vermerk.\\
Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{RELEASE\_YEAR}{Installationsjahr}{2020}{
Das ist das Jahr indem die Software installiert wurde. Diese wird im Footer verwendet
und ist das Startjahr in der Copyrightangabe.\\
Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{SHOW\_GITHUB}{Soll der Link zu GitHub im Footer angezeigt werden?}{true}{
Soll die Verlinkung zu GitHub angezeigt werden? Diese darf nur dann abgeschaltet werden,
wenn die Namensnennung und Lizenznennung woanders auf der Seite erfolgt.\\
Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{SHOW\_IMPRINT}{Soll ein Link zum Impressum im Footer angezeigt werden?}{true}{
Soll ein Link zum Impressum im Footer angezeigt werden?\\
Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{IMPRINT\_LINK}{Link zum Impressum}{https://www.musterseite.de/impressum}{
Dies ist der Link zum Impressum, welcher verwendet wird, um auf das Impressum
zu verlinken. Dieser muss gesetzt sein, wenn der Link zum Impressum angezeigt werden
 soll.\\
 Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{SHOW\_DSGVO}{Soll ein Link zur Datenschutzerklärung im Footer angezeigt werden?}{true}{
Soll ein Link zur Datenschutzerklärung im Footer angezeigt werden?\\
Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{DSGVO\_LINK}{Link zur Datenschutzerklärung}{https://www.musterseite.de/datenschutz}{
Dies ist der Link zur Datenschutzerklärung, welcher verwendet wird, um auf die Datenschutzerklärung
zu verlinken. Dieser muss gesetzt sein, wenn der Link zur Datenschutzerklärung angezeigt werden
 soll.\\
 Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{SHOW\_SCHOOL\_LINK}{Soll ein Link zur Schule im Footer angezeigt werden?}{true}{
Soll im Footer ein Link zur Schule angezeigt werden?\\
Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

\DescribeOption{SCHOOL\_LINK}{Link zur Schule}{https://www.musterseite.de/}{
Dies ist der Link zur Schule, welcher verwendet wird, um auf die Seite der Schule
zu verlinken. Dieser muss gesetzt sein, wenn der Link zur Schule angezeigt werden
 soll.\\
 Neu ab \hyperref[subsec:ver_1.1.0]{Version 1.1.0}.
}

Sobald die Konfigurationsdatei entsprechend den Bedürfnissen mit einem Texteditor
angepasst worden ist, kann man die Software bereitgestellt\footnote{veröffentlichen}.

\subsection{Veröffentlichung}

Für die Veröffentlichung muss nun einfach die gesamte Ordnerstruktur, die am Anfang
herunterladen geladen worden ist, einfach nur noch auf den Server geladen werden.
Wenn es ein Server ist, der auf dem eigenem System läuft, dann reicht es aus, den
kompletten Inhalt des Ordners in den Serverordner zu kopieren. Falls man jedoch einen
externen Server besitzt, dann wird man die Dateien höchstwahrscheinlich mittels
FTP transferieren.

\textbf{Wichtige Anmerkung}: Die Ordner |sql| und |documentation| werden für den produktiven Betrieb nicht
benötigt. Damit man ein sicheres System hat wird empfohlen die beiden Ordner nicht
auf den Server zu laden oder wenn sie schon auf dem Server sind, sie von dort zu löschen.
Dies ist Teil von \href{https://de.wikipedia.org/wiki/Security_through_obscurity}{Security by obscurity}.
Falls bei der Bereitstellung auch noch Ordner mit den Namen |.idea| oder |.git| auftauchen,
dann können Sie diese auch entfernen. Diese werden nur für die Weiterentwicklung
der Software benutzt und sind für die produktive Nutzung überflüssig.

Nachdem man das gesamte System veröffentlicht hat, sollte man nochmal kontrollieren,
ob man sich auf der Seite anmelden kann und alles funktioniert.

\section{Nutzung}

In diesem Kapitel der Dokumentation werden nun die einzelnen Aspekte und Ansichten
in der Software beschreiben und dokumentiert. Dies sollte einem einen entsprechend
guten Überblick über die Software geben.

Alle Parameter werden in folgendem Format dargestellt:

\DescribeOption{Stichwort}{Name}{Beispielwert für die Sportwahl}{
  Zusammenfassung des Parameters inklusive seiner Bedeutung.
}

\subsection{Anmeldeseite}

Wenn man \name aufruft, so kommt man am Anfang immer zur Anmeldeseite, wo man sich
anmelden kann. Auf der Anmeldeseite kann man sich sowohl als normaler Nutzer als
auch Administrator anmelden. Denn nach der entsprechend erfolgreichen Anmeldung
wird man auf die entsprechend passende Seite automatisch weitergeleitet.

Auf der Seite gibt es ein Feld für den Benutzernamen und ein weiteres für das
Passwort des Nutzers. Darunter gibt es dann den Button\footnote{deut. Knopf}, womit
man die Anmeldung ausführen kann.

Falls man sein Passwort vergessen hat, dann kann man unten auf einen Hyperlink
mit der Aufschrift \glqq Accountdaten vergessen\grqq{} drücken. Dies lässt eine kleine
Box unten erscheinen, wo ein Hinweis dazu steht. Dazu soll man entweder seinen
zuständigen Lehrer fragen oder sich an den Administrator der Platform wenden.

Die Anmeldeseite kann auch Fehler ausgeben. Diese erscheinen immer unter der
Navigationsleiste mit \name. Diese sind \textcolor{red}{\textbf{rot}} hinterlegt
und enthalten entsprechend Textmeldungen. Falls ein Fehler bei der Anmeldung auftritt,
dann bekommt man eine Meldung, dass die eingegebenen Daten nicht gefunden werden konnten.
Andere Fehler sorgen für andere Fehlermeldungen, jedoch sind diese so verfasst,
dass diese auf der Anmeldeseite relativ wenige Informationen ausgeben. Falls ein
interner Fehler auftritt, dann kann es mehrere Ursachen haben. Entweder funktioniert
die Verbindung zur Datenbank nicht oder andere Parameter wurde nicht übertragen.

Es kann durchaus dazu kommen, dass wenn man eine Seite der \name direkt aufruft
ohne die entsprechend Vorgaben zu erfüllen, dass dann die Session von einem
gelöscht wird und man auf die Anmeldeseite automatisch weitergeleitet wird.
Genaueres dazu ist im Abschnitt |Seitenpolicy| zu finden.

\subsubsection{Abmeldung}

Sobald man sich angemeldet hat, sieht man auf jeder der Seiten die Navigationsleiste
mit der Aufschrift \name. Ganz rechts auf der Navigationsleiste steht der Text
\glqq Logout\grqq{}, womit man sich abmelden kann.

\subsection{Hauptseite}

Die Hauptseite bekommt man nach der Anmeldung zu gesicht. Für einen Administrator
sind dort alle Kurswahlen aufgelistet, die es gibt. Dazu gibt es noch zwei spezielle
Einträge mit \glqq Neue Wahl!\grqq{} und \glqq Schüler\grqq{}. Bei der ersten Kachel
kann man eine neue Kurswahl erstellen. Dies ist im Abschnitt |Wahl erstellen|
dokumentiert. Mit der zweiten Kachel gelangt man zur |Teilnehmerverwaltung|.
Dort kann man alle Nutzer der Platform einsehen und verwalten. Nur Nutzer mit
Administratorrechten können auf die Teilnehmerverwaltung zugreifen und Wahlen erstellen,
bearbeiten, auswerten und löschen.

Normale Nutzer bekommen nur eine Liste der Kurswahlen, an denen sie teilnehmen oder
schon teilgenommen haben. Falls man an keiner Kurswahl teilnimmt dann bekommt
man den Text angezeigt, dass für einen keine Wahlen zur Verfügung stehen.

\subsection{Wahl erstellen}

Eine Kurswahl benötigt folgende Parameter:

\DescribeOption{Name}{Name der Kurswahl}{Sportwahl 2020}{
  Dies ist der Name der Kurswahl. Dieser wird dann auf der Kachel der Hauptseite
  als auch an allen anderen Stellen angezeigt. Er dient dazu diese Wahl von
  vergangenen Wahlen oder anderen Wahlen zu unterscheiden.
}

\DescribeOption{Beschreibung}{Beschreibung der Kurswahl}{Sportkurse für E1 bis Q4}{
  Dies ist die Beschreibung der Kurswahl. Diese sollte kurz die Kurswahl beschreiben und
  den Namen der Kurswahl unterstützen.
}

\DescribeOption{Wunschabgaben}{Anzahl der Schülerwünsche}{3}{
  Die Anzahl der Schülerwünsche ist eine natürliche Zahl größer |0| und gibt an,
  wie viele Wünsche jeder Schüler abgeben kann. Diese Zahl darf nicht kleiner
  als die |Kurszuteilung| sein. Empfohlen wird außerdem, dass die Anzahl der Schülerwünsche
  kleiner als die Anzahl der Kurse für die Wahl ist, da dies an anderen Stellen im
  System Probleme verursacht.
}

\DescribeOption{Kurszuteilung\label{itm:Kurszuteilung}}{Anzahl der Kurse, die ein Teilnehmer bekommen soll}{1}{
  Die Anzahl der Schülerwünsche ist eine natürliche Zahl größer |0| und gibt an,
  wie viele Kurse ein Schüler eingeteilt werden soll. Für die meisten Kurswahlen
  reicht hier |1|, da jedoch auch Wahlen mit mehreren Kursen pro Nutzer möglich sein
  sollen, muss dies hier angegeben werden.
}

\DescribeOption{Wahlbeginn}{Beginn der Wahl}{10.08.2020}{
  Dies ist der Zeitpunkt ab dem eine Wahl für die Nutzer zugänglich ist. Der Nutzer
  bekommt dennoch erst Zugriff zu der Wahl, wenn diese auch aktiviert ist, sodass
  trotz des angegebenen Datums die Teilnehmer erst später auf die Wahl zugreifen
  können. Die Teilnehmer bekommen eine Wahl zu sehen, sobald diese aktiviert ist
  und der Teilnehmer der entsprechenden Kurswahl zugeteilt ist. Dennoch können
  die Nutzer erst ab dem Beginn der Wahl ihre Stimmen abgeben. Das Datum des |Wahlbeginns|
  muss kleiner als das Datum des |Wahlendes| sein.
  Empfehlung: Geben sie jeder Wahl ca. eine Woche Zeit zur Stimmabgabe. Jedoch
  kann diese schon früher erstellt und aktiviert werden, sodass die Schüler auch
  schon früher Einsicht in die Wahl bekommen können.
}

\DescribeOption{Wahlende}{Ende der Wahl}{19.08.2020}{
  Das Ende der Wahl ist der Zeitpunkt, an dem die Wahl beendet. Dies passiert
  um 23:59, sodass die Teilnehmer den ganzen Tag noch nutzen können, um ihre Stimme
  abzugeben oder ihren Stimmwunsch zu ändern. Der Zeitpunkt für das |Wahlende| muss
  größer als der Zeitpunkt für den |Wahlbeginn| sein.
}

\subsection{Teilnehmerverwaltung}

In der Teilnehmerverwaltung sieht man eine Liste mit allen Nutzern, die in dem
System aktuell eingetragen sind. Dies sind nicht nur die Teilnehmer sondern auch
alle Administratoren. In dieser Liste sind folgende Informationen aufgelistet:

\begin{multicols}{3}
  \begin{itemize}
    \item |Nutzer-ID|
    \item |Vorname|
    \item |Nachname|
    \item |Benutzername|
    \item |Passwort|\footnote{Hier im Klartext}
    \item |Aktiviert?|\footnote{Zeigt an, ob der Account aktiviert ist}
    \item |Admin?|\footnote{Besitzt der Nutzer Administratorrechte}
    \item |Jahrgang|
    \item |Klasse|
  \end{itemize}
\end{multicols}

Hinter jedem Nutzereintrag gibt es noch zwei Aktionsbutton. Der erste dient zur
Bearbeitung des Nutzers und mit dem zweiten Button kann man den Nutzer entsprechend
löschen. Diesen Nutzer kann man nur dann löschen, wenn dieser Nutzer nicht der
eigene Nutzer ist. Dies soll verhindern, dass man als Administrator sich seinen
Zugang zur Platform nicht versperrt.

Zusätzlich gibt es am unteren Ende der Liste die Möglichkeiten neue Nutzer zu erstellen oder Nutzer
automatisch aus einer CSV-Datei zu importieren. Ganz oben auf der Seite gibt es
jedoch einen \textcolor{red}{\textbf{roten Button}} mit dem man alle Teilnehmer
löschen kann, die keine Administratorrechte besitzen. Somit kann man mit dieser
Funktion die Nutzerliste vor einem neuen Schuljahr aufräumen.

\textit{Technische Notiz}: Es werden hier nur die Einträge auf der Tabelle |tbl_users|
gelöscht, sodass im Fehlerfall man immer noch die Wahlergebnisse als auch die
Teilnahmen des Nutzers besitzt.

\subsection{Nutzer erstellen}

Dieses Formular dient zur Erstellung von neuen Nutzern als auch der Bearbeitung
von schon vorhandenen Nutzern. Dabei läuft beides bis auf eine Ausnahme identisch
ab. Ein Nutzer wird nur dann erstellt oder aktualisiert, wenn die angegebenen Daten
auch passen. Wenn irgendwo ein Fehler vorliegt, dann wird dieser angezeigt und man
kann die Daten entsprechend korrigieren. Bei der Bearbeitung eines Nutzers werden
die Änderungen nur dann übernommen, wenn man dies auch bestätigt. Man kann die Bearbeitung
also jederzeit ohne jegliche Auswirkungen auf das System abbrechen.

Folgende Informationen sind wichtig für die Erstellung und Bearbeitung von Nutzern:

\DescribeOption{Vorname}{Vorname des Nutzers}{Max}{
  Dies ist der Vorname eines Nutzers. Dieser darf nicht leer sein.
}

\DescribeOption{Nachname}{Nachname des Nutzers}{Mustermann}{
  Dies ist der Nachnamen eines Nutzers. Dieser darf nicht leer sein.
}

\DescribeOption{Benutzername}{Benutzername}{Max.Mustermann}{
  Dies ist der Benutzername, mit dem sich der Nutzer dann anmelden wird.
}

\DescribeOption{Geburtsdatum}{Geburtsdatum des Nutzers}{01.01.2020}{
  Dies ist das Geburtsdatum des Nutzers. Falls es zwei Nutzer mit dem gleichen
  Namen gibt, dann sollte dies in dem unwahrscheinlichen Fall das entsprechende
  Unterscheidungskriterium sein.
}

\DescribeOption{Passwort}{Passwort für den Nutzer}{passwort}{
  Der Nutzer benötigt für die Anmeldung ein Passwort. Das Passwort darf nicht
  leer sein und sollte mindestens |8| Zeichen lang sein.

  \textbf{Anmerkung}: Das hier gezeigt Beispielpasswort ist in keinerlei Hinsicht
  sicher und sollte niemals verwendet werden.
}

\DescribeOption{Aktiv}{Ist der Account aktiv?}{Ja}{
  Dies ist eine Checkbox, womit mit man einstellen
  kann, ob der Account wirklich aktiv ist. Wenn ein Haken da ist, dann ist bzw.
  soll der Account aktiv sein. Wenn dort kein Haken zu sehen ist, dann ist der
  Account nicht aktiv.
}

\DescribeOption{Jahrgang}{Jahrgang des Nutzer}{10}{
  Für die Nutzer gibt es eine Möglichkeit den Jahrgang anzugeben. Diese Feld muss
  auch entsprechend befüllt werden. Es dient dazu, dass man ganze Gruppen von
  Schülern einfach zu einer Kurswahl hinzufügen kann. Dabei muss jedoch dafür
  gesorgt werden, dass alle Jahrgangseinträge für den gleichen Jahrgang identisch
  sind, denn nur dann funktioniert es einwandfrei. Das auch Administratoren
  einen Jahrgang benötigen ist hier der \textit{Tipp}: Einfach eine entsprechend
  große Nummer, wie die |100| oder so, nehmen und diese allen Administratoren
  geben. Diese können entsprechend identifiziert werden und es fällt auf, dass
  dies kein gewöhnlicher Jahrgang ist.
}

\DescribeOption{Klasse}{Klasse des Nutzer}{10E}{
  Für die Nutzer gibt es eine Möglichkeit die Klasse anzugeben. Diese Feld muss
  auch entsprechend befüllt werden. Es dient dazu, dass man ganze Gruppen von
  Schülern einfach zu einer Kurswahl hinzufügen kann. Dabei muss jedoch dafür
  gesorgt werden, dass alle Klassenseinträge für die gleiche Klasse identisch
  sind, denn nur dann funktioniert es einwandfrei. Das auch Administratoren
  eine Klasse benötigen ist hier der \textit{Tipp}: Hier einfach eine Text wie
  |Admins| verwenden und schon hat man einen passenden Klassennamen.
}

\DescribeOption{Administrator}{Soll dieser Nutzer Administratorrechte besitzen}{Nein}{
  Dies ist eine Checkbox, womit mit man einstellen kann, ob der Account
  Administratorrechte besitzen soll. Wenn ein Haken da ist, dann ist bzw.
  soll der Account diese Rechte haben. Wenn dort kein Haken zu sehen ist, dann ist der
  Account ein normaler Nutzeraccount.
}

\subsubsection{CSV-Import}

Der CSV\footnote{Comma separated values - Durch Kommas getrennte Werte}-Import ist dazu entwickelt worden, dass man sehr schnell eine große
Anzahl von Schülern in das System eintragen kann. Dies kann dadurch sinnvoll sein,
dass es bereits entsprechende Listen mit den Daten gibt und diese nun damit
genutzt werden können.

Damit man Schüler importieren kann, benötigt man eine |CSV-Datei| mit folgender
Formattierung:

\begin{lstlisting}[style=tex]
<Vorname>;<Nachname>;<Geburtsdatum>;<Jahrgang>;<Klasse/TG>
\end{lstlisting}

Wenn man sich für den CSV-Import entschieden hat, dann wird zu einem Upload-Formular
weitergeleitet. Dort muss man die CSV-Datei entsprechend auswählen und hochladen.
Es werden zwar in der Auswahl alle Dateitypen erlaubt, jedoch nimmt hier das
System nur |txt|- und |csv|-Dateien an. Andere Dateitypen werden für entsprechende
Fehlermeldungen sorgen.

Nachdem Upload wird die Datei im Ordner |uploads| zwischengespeichert und verarbeitet.
Dazu wird die Datei durchgeganen und jeder Nutzer in die Datenbank eingetragen.
Der Benutzername als auch das Passwort werden automatisch generiert. Diese
Accounts sind standardmäßig aktiviert und besitzen \textbf{keine} Administratorrechte.

Sobald die Verarbeitung erfolgreich durchgeführt worden ist, wird die ursprüngliche
hochgeladene und im Ordner |uploads| gespeicherte |CSV-Datei| gelöscht, sodass
keinerlei Rückstände zurückbleiben. Tritt jedoch ein Fehler bei der Verarbeitung
der |CSV-Datei|\footnote{Die Datei wird im Laufe des Uploads umbenannt, sodass sie nun \glqq students.*\grqq{} heißt.}
auf, so kann es sein, dass diese nicht korrekt gelöscht wird. Nach der erfolgreichen
Verarbeitung wird man wieder auf die Übersicht aller Nutzer weitergeleitet.

\subsection{Verwaltung einer Wahl}

Wenn man als Administrator auf eine Wahl klickt, so bekommt man eine Übersicht
der Wahl und eine Vielzahl an Einstellungen.

Ganz oben wird der |Name|, die |Beschreibung| als auch der Zeitraum der Wahl angezeigt.
Außerdem wird dort auch angezeigt, ob die Wahl |aktiv| ist oder nicht. Falls die
Wahl deaktiviert ist, so befindet sich unter der Zusammenfassung ein Button mit der
Beschriftung \glqq Wahl aktivieren!\grqq{}, womit man die Wahl aktivieren kann. Falls
die Wahl aktiv ist, dann kann sie dann über den Button \glqq Wahl deaktivieren!\grqq
deaktiviert werden. Daneben gibt es noch einen \textcolor{red}{\textbf{roten hinterlegten}}
Button mit der Aufschrift \glqq Wahl löschen!\grqq{}, womit man eine ganze Wahl inklusive
Kurse und Ergebnisse löschen kann.

Dadrunter gibt es die Möglichkeit eine Zusammenfassung hochzuladen. Dies muss eine
|PDF-Datei|\footnote{Portable Document File - deut. portable Dokumentdatei} sein.
Wenn schon eine Zusammenfassung hochgeladen wurde, dann kann man die Zusammenfassung
ansehen. Alle Zusammenfassungen sind im Ordner |docs| gespeichert. Diese Zusammenfassung
kann man nach Abschluss der Wahl auch wieder löschen mit dem entsprechend \textcolor{red}{\textbf{roten hinterlegten}}
Button.

Dadrunter gibt es eine Auflistung aller Kurse. Dort wird das |Kürzel|, der |Name|,
der |Lehrer|, |Minimum| als auch |Maximum| angezeigt. Neben jedem Eintrag in der
Kursliste gibt es die Möglichkeit, |Minimum| und |Maximum| zu bearbeiten. Außerdem
gibt es die Möglichkeit, den vorhandenen Kurs zu löschen. Es wird empfohlen, dies
nur wären der Erstellung der Wahl zu tun. Für die Erstellung eines neuen Kurses
muss man nur auf \glqq Kurs anlegen!\grqq{} drücken. Alles weitere zu dem Thema ist
im Abschnitt |Erstellung von Kursen| dokumentiert.

Unter der Kursliste steht eine Liste mit allen Teilnehmern. Jeder Teilnehmer
hat einen Eintrag. Dort wird der |Vorname|, der |Nachname|, der |Jahrgang|
und die |Klasse| angezeigt. Falls ein Nutzer fälschlicher Weise trotzdem hinzugefügt
worden ist, so kann dieser mit einem Klick auf das Symbol eines Mülleimers gelöscht
werden. Natürlich kann man auch neue Teilnehmer hinzufügen. Dazu muss nur auf
\glqq Teilnehmer hinzufügen\grqq{} gedrückt werden. Alles weitere zu dem Thema wird
im Abschnitt |Teilnehmer hinzufügen| dokumentiert.

Hierunter gibt es die Möglichkeit, die aktuell |Statistik| zur Kurswahl anzusehen.
Dazu muss man nur auf \glqq Statistik ansehen\grqq{} klicken. Alles weitere wird im
Abschnitt |Statistikansicht| beschrieben.

Dadrunter gibt es die Möglichkeit sich die Zugangsdaten der Teilnehmer für die
Kurswahl ausgeben zu lassen. Wenn man auf \glqq Zugangsdaten ausgeben\grqq{} drückt,
so bekommt man eine Liste mit allen Teilnehmern der Kurswahl. Daneben sind außerdem
auch der |Benutzername| als auch das |Passwort| aufgelistet. Ganz unten am Ende
dieser Liste hat man die Möglichkeit, sich diese Zugangsdaten als Datei herunterzuladen.
Dies kann man als |CSV-Datei| machen, wo die Daten dann folgendes Format haben:

\begin{lstlisting}[style=tex]
<Vorname>,<Nachname>,<Klasse/TG>,<Jahrgang>,
<Benutzername>,<Passwort>
\end{lstlisting}

Alternativ kann sich diese Liste auch als |PDF-Datei| herunterladen, die einfach
eine Tabelle mit den Inhalten enthält.

Ganz unten am Ende der Seite hat man die Möglichkeit, die Kurswahl auszuwerten.
Alles wichtige dazu steht im Abschnitt |Auswertung einer Wahl|.

\subsubsection{Erstellung von Kursen}

Für die Erstellung von Kursen werden folgende Informationen benötigt:

\DescribeOption{Kursname}{Name für den Kurs}{Sportabitur}{
  Der Name des Kurses soll den Kurs identifizieren. Dieser darf nicht leer sein
  und sollte außerdem auch nicht zu lang sein.
}

\DescribeOption{Beschreibung}{Beschreibung des Kurses}{Verpflichtender Kurs für das Abitur in Sport}{
  Die Beschreibung soll nochmal kurz zusammenfassen, worum es in diesem Kurs geht. Diese
  darf nicht leer sein.
}

\DescribeOption{Lehrkraft}{Name der Lehrkraft}{Hr. Musterlehrer}{
  Der Name der Lehrkraft soll dem Administrator dieser Wahl helfen, den Überblick
  über alle Kurse zu behalten. Dieses Feld muss befüllt werden und es darf nicht
  leer sein.
  \textbf{Anmerkung}: Dieser Name wird nur im Administrationsbereich einer Kurswahl
  angezeigt und soll dort für Übersichtlichkeit sorgen. Zu keinem Zeitpunkt im
  Ablauf einer Wahl wird dieser Name einem normalen Nutzer angezeigt.
}

\DescribeOption{Minimum}{Minimalanzahl der Teilnehmer}{10}{
  Dies ist die Anzahl an Schüler, die benötigt wird, damit ein Kurs stattfindet.
  Diese Zahl ist für die Einteilung nicht ganz so wichtig, da diese noch abgesprochen
  werden kann. Es muss eine ganze Zahl sein, die größer gleich |0| ist. Jedoch darf die
  |Minimalanzahl| nicht größer als die |Maximalanzahl| sein.
}

\DescribeOption{Maximum}{Maximalanzahl der Teilnehmer}{15}{
  Dies ist die maximale Anzahl an Schüler, die am Kurs teilnehmen können. Diese Zahl
  muss größer gleich |0| sein. Außerdem darf die Anzahl auch nicht kleiner als
  die |Minimalanzahl| sein. Der Algorithmus versucht alle überfüllten Kurse
  anhand der Wünsche so umzuverteilen, sodass am Ende am besten kein Kurs mehr
  überfüllt ist. Sollte danach trotzdem ein Kurs überfüllt sein, so bleiben die
  Nutzer darin. So hat der Administrator immer noch die volle Kontrolle, ob er
  einen Kurs mit mehr Teilnehmern stattfinden lässt, einen anderen Kurs streicht
  und diesen zwei Mal anbietet oder manuell die Teilnehmer in andere Kurse verlegt.
  Außerdem werden keine Schüler von dem System in Kurse gesteckt, wofür sie keine
  Wünsche abgegeben haben.
}

\DescribeOption{Beginn}{Kursbeginn}{17.08.2020 00:00}{
 Die ist der Startzeitpunkt eines Kurses. Dieser |Startzeitpunkt| wird nämlich
 mit dem |Endzeitpunkt| dafür genutzt, um die Zeitleiste dieses Kurses zu bestimmen.
 Da das \name auch in der Lage ist, Kurswahlen durchzufühen, wo man Kurse aus mehreren
 Zeitleisten wählen kann, muss man angeben in welcher Zeitleiste sich dieser Kurs
 befindet. Dies führt dazu, dass alle Kurse die gleichzeitig stattfinden und daher
 der Nutzer aus dieser Menge von Kursen nur einen Kurs auswählen soll, die gleiche
 Zeitleiste besitzen müssen. Dadurch müssen dort |Startzeitpunkt| und |Endzeitpunkt|
 gleich sein. Für die Auswertung einer Wahl muss zusätzlich dafür gesorgt werden,
 dass die Anzahl an |Zeitleisten| gleich der |Kurszuteilung|\footnote{Siehe Abschnitt \ref{itm:Kurszuteilung}}
 der Kurswahl ist. Denn nur dann können die Teilnehmer in die entsprechenden
 Kurse eingeteilt werden. Generell muss der |Startzeitpunkt| immer vor dem |Endzeitpunkt|
 liegen.
}

\DescribeOption{Ende}{Kursende}{21.08.2020 23:59}{
Die Funktion des Kursendes wird im Abschnitt zum |Kursbeginn| ausführlich erklärt.
Hier kommt nur noch die Anmerkung, dass der |Endzeitpunkt| immer größer bzw. später
als der |Startzeitpunkt| sein muss.
}

\DescribeOption{Alias}{Alias für den Kurs}{A}{
  Da man nicht immer den kompletten Kursnamen abdrucken kann oder möchte, gibt es
  das |Alias|. Es ist gedacht als ein Zeichen, welches direkt aussagt, um welchen
  Kurs es sich hier handelt. Jeder Kurs braucht ein anderes |Alias| und es darf
  nicht leer sein.
}

\subsubsection{Teilnehmer hinzufügen}

Es gibt mehrere Möglichkeit Teilnehmer hinzuzufügen. Ganz oben hat man eine Liste
an Klassen und Jahrgängen, die man hinzufügen kann. Diese Liste wird durch die
Nutzerliste erstellt, wobei alle Nutzer durchgeschaut werden und jede neue Klasse
bzw. Jahrgang dann aufgelistet wird. Wenn man dann sich dazu entscheidet, eine Klasse
oder einen kompletten Jahrgang hinzuzufügen, dann werden alle Nutzer zu der Kurswahl
hinzugefügt, die in dieser Klasse oder diesem Jahrgang sind und noch nicht an der Wahl
teilnehmen. Zum Hinzufügen muss einfach der Button mit der Beschriftung \glqq Hinzufügen\grqq{}
gedrückt werden.

Natürlich kann man auch Nutzer einzeln hinzufügen. Dazu gibt es unterhalb der Liste
der Klassen und Jahrgängen noch eine Liste mit allen Nutzern, die zwar im System
eingetragen sind, aber noch nicht an der ausgewählten Kurswahl teilnehmen. Zum Hinzufügen
muss an dieser Stelle auch nur der entsprechende Button gedrückt werden.

\subsubsection{Statistikansicht}

Die |Statistikansicht| soll wärend einer Wahl Auskunft über das Geschehen informieren.
Somit bekommt man eine Möglichkeit, relativ früh zu sehen, welche Teilnehmer noch
keine Stimme abgegeben haben und wie viele Erststimmen es für welchen Kurs gab.

Dies gesamte Statistik basiert auf Echtzeitdaten, jedoch aktualisiert sie sich
nicht von selbst. Dazu muss die Seite neu geladen, damit die aktuellsten Daten
angezeigt werden können. Dies geht unteranderem mit der |F5|-Taste.

Ganz oben gibt es eine |Säulendiagramm|, wo unten alle Kurse mit ihren Kürzel
angezeigt sind und links die Anzahl an Erststimmen angezeigt ist. Dadrunter gibt
es noch eine Auflistung aller Nutzer, die noch keine Stimme abgegeben haben. Zusätzlich
gibt es auch noch eine Anzeige, wie viele Stimmen bis jetzt überhaupt abgegeben worden
sind.

\subsection{Auswertung einer Wahl}

Man kann eine Kurswahl mehrfach auswerten, da man die Auswertung immer wieder
zurücksetzen kann. Dazu kann man eine Wahl auch schon wärend der Wahlphase auswerten,
jedoch ist dies nicht das finale Ergebnis und es können sich noch einige Abgaben
ändern. Am besten ist es einfach, wenn man die Wahl erst dann auswertet, wenn sie
beendet ist.

Zur Auswertung der Wahl muss sichergestellt sein, dass es genügend Kursplätze gibt.
Daher muss die Summe aller Kurse für eine Zeitleiste größer oder gleich der
Anzahl der Teilnehmer sein. Außerdem muss sichergestellt sein, dass die Anzahl
der Zeitleisten der Kurse mit der Anzahl an Kursen übereinstimmt, in die ein Schüler
eingeteilt werden soll.

Die Auswertung einer Wahl ist schnell erledigt und nach der Auswertung der Wahl
kommt man auf eine Übersicht der Einteilung. Solange eine Wahl ausgewertet ist,
kann man sich diese Einteilung ansehen. Dazu gibt es für jeden Kurs einen Abschnitt,
der jeweils das Kurs-|Alias| als auch den |Kursnamen| als Überschrift trägt.
Dadrunter sind dann die eingeteilten Schüler des Kurses mit |Vorname|, |Nachname|
und |Klasse| aufgelistet.

Unter der ganzen Auflistung ist dann der Button zum zurücksetzen der Wahl. Solange
keine Daten verändert werden, liefert der Algorithmus immer das gleiche Ergebnis
zurück, was dies erst ermöglicht. Dadrüber gibt es noch eine Möglichkeit sich
die Wahlergebnisse als |PDF-Datei| als auch als |CSV-Datei| herunterzuladen. Die
PDF-Datei enthält eine Liste mit Vorname, Nachname, Klasse, Jahrgang und dem
Kurskürzel. Die CSV-Datei ist fast identisch aufgebaut. Sie hat nur vorne nochmal
eine Eintragsnummer.

\begin{lstlisting}[style=tex]
<Nr>,<Vorname>,<Nachname>,<Klasse/TG>,<Jahrgang>,<Alias>
\end{lstlisting}

\name verhindert nicht, dass man sich für einen Kurs mehrfach wünscht. Dies erhöht
jedoch nicht die Wahrscheinlichkeit für den einzelnen |Teilnehmer| in diesen Kurs
zu gelangen. Wenn der Kurs von Anfang an nicht überfüllt war, dann wird er sowieso
in diesen Kurs eingeteilt. Wenn der Kurs jedoch überfüllt ist, dann wird ein Nutzer,
der als Beispiel drei Mal das gleiche angegeben hat, automatisch am Anfang in diesen
Kurs eingeteilt. Dies hat aber noch nichts zu bedeuten. Der Algorithmus versucht
nämlich die Einteilung zu optimieren und wird dabei so viele Teilnehmer wie möglich
noch umverteilen. Wenn am Ende der Einteilung und der Optimierung noch ein Kurs
überfüllt ist, dann hat ein Nutzer, der drei unterschiedliche überfüllte Kurse
gewählt hat, die gleichen Chancen, wie ein Nutzer, der drei Mal den gleichen
Kurs gewählt hat. Da am Ende der Administrator sich die Gedanken macht, wie er
die Kurse in der Realität stattfinden lässt, ob der dabei noch einzelne Schüler
verschiebt, einen Kurs ganz streicht und durch einen anderen ersetzt oder einfach
den Kurs so lässt, hat keiner einen Vorteil.

\subsubsection{Funktionsweise des Algorithmus}

\begin{enumerate}
  \item Kontrolliere, ob es für die Wahl überhaupt genügend Plätze gibt. Dazu
  wird die |Kurszuteilung| mit der |Anzahl der Teilnehmer| multipliziert und mit
  der Summe der |Maximalanzahl| aller Kurse verglichen. Ist die Summe kleiner
  als die Anzahl der benötigten Plätze, so wird die Wahl nicht ausgewertet.
  \item Gruppiere alle Kurse zusammen in |Zeitleisten|
  \item Kontrolliere, ob die Anzahl der |Zeitleisten| gleich der |Kurszuteilung|
  ist. Nur wenn die Bedingung erfüllt ist, wird der Algorithmus fortgesetzt.
  \item Gehen nun durch jede |Zeitleiste dieser Wahl|. Dies passiert mit Hilfe von
  einem Index, welcher hier bei |1| und nicht wie in der Informatik üblich bei |0|
  anfängt.
  \begin{enumerate}
    \item Erstelle einen Kurs für alle Teilnehmer, die keine Stimme abgegeben
    haben. Dieser Kurs wird heißt \glqq Übrige Schüler\grqq{} und enthält außerdem
    noch die Nummer der Zeitleiste. Das |Alias| ist ein Minus und die |Zeitleistennummer|.
    Dieser Kurs ist so groß, dass dort alle Teilnehmer hinpassen.
    \item Gehe nun durch alle Teilnehmer der Wahl.
    \begin{enumerate}
      \item Iteriere nun über alle möglichen Wünsche des Teilnehmers. Beginne
      beim Erstwunsch.
      \begin{enumerate}
        \item Kontrolliere, ob der Nutzer einen \textbf{n}-ten Wünsch abgegeben hat
        für einen Kurs dieser Wahl, welcher in der aktuellen Zeitleiste liegt.
        \item Falls es diesen Wunsch gibt, dann teile den Nutzer in diese Kurs ein
        und mach mit dem nächsten Nutzer weiter.
        \item Falls jedoch |kein| Wunsch gefunden wurde, dann schaue nach dem nächsten
        Wunsch.
      \end{enumerate}
      \item Falls die vorherige Suche zu keinerlei Ergebnissen geführt hat und alle
      Wünsche durchgeschaut sind, dann erstelle einen Eintrag in der Datenbank und
      füge den aktuellen |Teilnehmer| dem Kurs für alle Übrigen hinzu.
    \end{enumerate}
    \item Sobald durch alle |Teilnehmer| iteriert wurde, sollte jeder Teilnehmer
    entweder in einem ersten gültigen Wünschkurs sein oder falls er keinen Kurs
    angegeben hat im Kurs mit allen übrigen Teilnehmern. Nun wird nochmals
    versucht das Ergebnis zu optimieren.
    \item Iteriere nun über alle |Kurse|, die es in dieser |Zeitleiste| gibt.
    \begin{enumerate}
      \item Kontrolliere, ob der aktuelle Kurs überfüllt ist.
      \item Falls der Kurs nicht überfüllt ist, dann mach mit dem nächsten Kurs
      weiter.
      \item Wenn der Kurs überfüllt ist, dann bestimme nochmal alle Teilnehmer,
      die diesem Kurs zugeteilt sind.
      \begin{enumerate}
        \item Kontrolliere, ob der Teilnehmer noch einen weiteren Wunsch für einen
        Kurs abgegeben hat, der in dieser Zeitleiste liegt und nicht überfüllt ist.
        Mache dies immer für alle Teilnehmer für den gleichen Stimmwunsch und
        kontrolliere erst dann die nächst größere Wunschnummer.
        \item Sollte der alternative Kurs in der Lage sein, noch einen weiteren
        |Teilnehmer| aufzunehmen, dann verschiebe den Teilnehmer in den neuen Kurs.
        \item Wenn nicht, dann mach weiter.
      \end{enumerate}
    \end{enumerate}
  \end{enumerate}
  \item Ausgabe des Ergebnisses
  \item \textbf{Fertig}
\end{enumerate}

\subsection{Übersicht der Wahl für Teilnehmer}

Wenn sich ein Schüler angemeldet hat, dann bekommt er ja auch eine Übersicht
aller Wahlen, an denen er teilnimmt. Wenn er auf eine Wahl klickt, so bekommt
er eine Übersicht. Oben steht der Name der Wahl als auch deren Beschreibung. Dadrunter
gibt es bis zu drei Buttons mit verschiedenen Aktionen. Mit einem Button kann man
wieder zurück zu Übersicht gelangen. Falls die Wahl eine Zusammenfassung als
PDF-Dokument hat, dann gibt es hier auch einen Button, womit man sich diese ansehen kann.
Wenn die Wahl läuft, dann gibt es dort auch die Möglichkeit mit der Abstimmung
zu beginnen. Der Ablauf davon wird im nächsten Abschnitt |Wahlfenster für die Teilnehmer|
dokumentiert.

Unterhalb dieser Aktionen gibt es eine Auflistung aller Kurse dieser Wahl. Dort
wird nochmals der Name, die Beschreibung als auch das Kürzel bzw. Alias des Kurses
angezeigt.

\subsection{Wahlfenster für die Teilnehmer}

Die Teilnehmer bekommen ein sehr aufgeräumtes Wahlfenster angezeigt. Für jede
Stimme bzw. jeden Wunsch, der abgegeben werden kann, gibt es eine neue Ansicht.
Dort steht oben in der Überschrift, um welche Stimme es sich gerade handelt.
Dadrunter bekommt der Nutzer eine ComboBox, woraus der dann einen der verfügbaren
Kurse auswählen kann. Wenn man die Option \glqq Bitte wählen...\grqq{} auswählt,
dann darf man erneut die Stimme abgeben, da diese Abgabe ungültig war. Dazu
gibt es auch eine passende Meldung. Wenn man seinen Kurs nun korrekt ausgewählt
hat und die Eingabe erfolgreich gespeichert worden ist, dann bekommt man eine
dazu passende Meldung. Solange noch weitere Stimmen abgegeben können, steht unten
die Aufschrift \glqq Weiter\grqq{} auf dem Button. Bei der letzten Stimme steht
unten dann \glqq Fertigstellen\grqq{}. Nach dem Klick auf Fertigstellen kommt man
auf eine Erfolgsmeldung, wo steht, dass man erfolgreich die Daten eingegeben hat.
Dort gibt es wieder einen Button, womit man zur Übersicht gelangen kann.

Man kann nicht mehr Stimmen abgeben, als vorgesehen ist. Man kann auch keinerlei
Werte eingeben, die ungültig sind. Wenn man möchte, dann kann man jedoch weniger
Stimmen abgeben. Dazu kann der Vorgang abgebrochen werden, in dem man einfach
nach der $x$-ten Stimme einfach die Wahlansicht schließt. Die bis dahin eingegebenen
und abgeschickten Einträge sind gespeichert. Das System kann fehlende Abgaben
handhaben, sodass dies kein Problem ist. \name fängt immer bei der ersten Stimme
an und zählt dann hoch. Das System ist dazu ausgelegt, dass man dann weiter
aufsteigend die Stimmen einträgt. Theoretisch kann man auch Wahlstimmen überspringen,
aber dies geht nur, wenn man selbst aktiv den Seitenparametern in der Adresszeile
des Browsers ändert. Es ist zwar konzeptionell nicht so geplant gewesen, jedoch
macht es dem System nichts aus.

Wenn man seine Stimmen schon abgegeben hat und noch etwas ändern möchte, dann kann
man dies wärend der Wahl tun. Dazu wählt man einfach nochmal. Die vorhandenen
Einträge werden in der Datenbank passend angepasst. So werden auch nur die Einträge
geändert, wo man die Stimme neu abgegeben hat. So kann man auch nur die Erststimme
neu wählen und danach abbrechen. Die Erststimme wird aktualisiert und alle weiteren
Stimmen bleiben unverändert.

\subsection{Seitenpolicy}

Das System gibt Meldungen aus. Davon gibt es zwei Arten. Fehlermeldungen werden
angezeigt, wenn ein Fehler aufgetreten ist. Diese sind \textcolor{red}{\textbf{rot}} hinterlegt.
Zusätzlich gibt es noch Erfolgsmeldung, die angezeigt werden, wenn eine Operation
erfolgreich durchgeführt worden ist. Diese sind \textcolor{green}{\textbf{grün}} hinterlegt.

Falls man eine Seiten der \name ohne gültige Anmeldung aufruft, dann wird man immer
auf die Anmeldeseite weitergeleitet. Das gleiche passiert auch, wenn auf einer der
Seiten ein Fehler auftritt.

Es können auch Nutzerfehler auftreten. Das kann ein fehlende oder eine ungültige
Eingabe sein. Diese Fehler behandelt das System und gibt entsprechend Rückmeldung
an den Nutzer. Dazu wird er auf die ursprüngliche Seite zurückgeleitet und sieht dort
die Meldung.

\section{Mitwirkende}

Dieses Projekt wurde in Zusammenarbeit mit mehreren Personen entwickelt, jedoch werden diese aus Datenschutzgrüden
her nicht veröffentlicht. Trotzdem ein Dankeschön an alle, die an diesem Projekt
beteiligt waren.

\section{Lizenzen}

\name ist unter der MIT Lizenz veröffentlicht:

\lstinputlisting[style=license]{LICENSE.txt}

Da diese Software Komponenten enthält und benutzt, welche anderer Personen oder
Entwickler erstellt haben, müssen auch deren Lizenzen aufgelistet werden. Diese
sind nun in den Unterabschnitten aufgelistet. Alle Angaben sind ohne Gewähr.

%Auflistung aller Teilkomponenten
\subsection{Bootstrap 4.1}

\lstinputlisting[style=license]{LICENSE_Bootstrap.txt}

\subsection{Font Awesome}

Die Lizenz ist in mehrere Teile unterteilt, die hier in den entsprechenden Unterpunkten
gelistet werden. Die komplette Lizenz ist hier zu finden:

\url{https://fontawesome.com/license/free}.

\subsubsection*{Icons}
CC BY 4.0 License (\url{https://creativecommons.org/licenses/by/4.0/})

\begin{lstlisting}[style=license]
In the Font Awesome Free download, the CC BY 4.0 license applies to all icons
packaged as SVG and JS file types.
\end{lstlisting}

\subsubsection*{Fonts}
SIL OFL 1.1 License (\url{https://scripts.sil.org/OFL})

\begin{lstlisting}[style=license]
In the Font Awesome Free download, the SIL OFL license applies to all icons
packaged as web and desktop font files.
\end{lstlisting}

\subsubsection*{Code}
MIT License (\url{https://opensource.org/licenses/MIT})

\begin{lstlisting}[style=license]
In the Font Awesome Free download, the MIT license applies to all non-font and
non-icon files.
\end{lstlisting}

\subsection{tFPDF}

Original author: Ian Back

Maintainer: Tycho Veltmeijer

License: LGPLv3

\lstinputlisting[style=license]{lgpl-3.0.txt}

\subsection{Popper.js}

\lstinputlisting[style=license]{LICENSE_Popper.txt}

\subsection{jQuery}

\lstinputlisting[style=license]{LICENSE_jQuery.txt}

\subsection{Chart.js}

\lstinputlisting[style=license]{LICENSE_ChartsJs.txt}

\section{Vorlage}

Die Dokumentation verwendet die Schriftart
\href{https://www.mozilla.org/en-US/styleguide/products/firefox-os/typeface/}
{Fira Sans}, welche von Mozilla bereitgestellt wird und von
\href{http://www.carrois.com/fira-3-1/}{Carrois} erstellt worden ist.

Als Vorlage für diese Dokumentation diente die Dokumentation des Projekts \textbf{mtheme},
welches auf \href{https://github.com/matze/mtheme}{GitHub} gefunden werden kann.

\section{Versionsgeschichte}
\label{sec:ver}

\subsection*{Version 1.1.0}
\label{subsec:ver_1.1.0}

\begin{itemize}
  \item Footer wird nun per \verb+include()+ eingebunden
  \item Automatische Erneurung des Copyright
  \item Verlinkung zum GitHub-Repository im Footer
  \item Verlinkungsmöglichkeit im Footer für das Impressum
  \item Verlinkungsmöglichkeit im Footer für die Datenschutzerklärung
  \item Verlinkungsmöglichkeit im Footer zur Schule
  \item Die Länge der automatisch generierten Passwörter kann nun eingestellt werden
  \item Fehlerbehebung einer falschen Verlinkung auf der Startseite \verb+index.php+
  \item Aktualisierung der \verb+.htaccess+-Dateien
\end{itemize}

\subsection*{Version 1.0.1}
\label{subsec:ver_1.0.1}

\begin{itemize}
  \item Einführung einer Dokumentation für das gesamte System
  \item Einführung einer Installationsanleitung
  \item SQL-Befehle zur Datenbankerstellung hinzugefügt
  \item Fehlerbehebung im Einteilungsalgorithmus bei der Optimierung bei Wahlen
  mit mehreren Zeitleisten
  \item Aktualisierung der Lizenz
  \item Rechtschreibkorrektur
\end{itemize}

\subsection*{Version 1.0.0}
\label{subsec:ver_1.0.0}

Ursprüngliche Einführung.

\section*{Anmerkung}

Dieses Dokument ist in seiner neusten Version auf \href{https://github.com/AlexanderKaschta/WeidigWahl}{GitHub} unter
folgender Url zu finden: \href{https://github.com/AlexanderKaschta/WeidigWahl/blob/master/documentation/documentation.pdf}{\url{https://github.com/AlexanderKaschta/WeidigWahl/blob/master/documentation/documentation.pdf}}

\end{document}
